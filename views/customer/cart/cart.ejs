<!DOCTYPE html>
<html lang="en">
  <%- include('../../shared/includes/head', {pageTitle: 'YOUR CART'}) %>
  <head>
    <link rel="stylesheet" href="/styles/cart.css" />
    <script src="/scripts/cart-item-management.js" defer></script>
  </head>
  <body>
    <%- include('../../shared/includes/header') %>
    <Main>
      <h1>Your Cart</h1>
      <ul id="cart-items">
        <% for(const cartItem of locals.cart.items) { %>
        <li><%- include('includes/cart-item',{item: cartItem}) %></li>
        <% } %>
      </ul>
      <div id="cart-total">
        <p>
          Total: $
          <span id="cart-total-price"
            ><%= locals.cart.totalPrice.toFixed(2) %></span
          >
        </p>
        <% if(locals.isAuth && locals.cart.totalQuantity > 0) { %>
        <form action="/orders" method="POST">
          <input type="hidden" name="_csrf" value="<%= locals.csrfToken %>" />
          <button class="btn">Buy Product</button>
        </form>
        <% } else { %>
        <p id="cart-total-fallback">
          Log in and add items to the cart to proceed and purchase the items.
        </p>
        <% } %>
      </div>
    </Main>
  </body>
  <%- include('../../shared/includes/footer') %>
</html>
